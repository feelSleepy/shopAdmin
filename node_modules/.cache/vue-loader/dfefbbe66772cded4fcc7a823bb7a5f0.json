{"remainingRequest":"/Volumes/d/project/shopAdmin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/d/project/shopAdmin/src/components/goods/goodsAttr.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Volumes/d/project/shopAdmin/src/components/goods/goodsAttr.vue","mtime":1577094910000},{"path":"/Volumes/d/project/shopAdmin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/d/project/shopAdmin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Volumes/d/project/shopAdmin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/d/project/shopAdmin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpleHBvcnQgZGVmYXVsdCB7DQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIC8vIOWkmuinhOagvOaooeadvw0KICAgICAgc3BlY1RlbXA6IHsNCiAgICAgICAgc3BlY05hbWU6ICcnLA0KICAgICAgICBzcGVjVmFsOiBbJyddDQogICAgICB9LA0KICAgICAgLy8g5aSa6KeE5qC85LiK6ZmQDQogICAgICBtYXhTcGVjOiAzLA0KICAgICAgLy8g5aSa6KeE5qC85YiX6KGoDQogICAgICBzcGVjTGlzdDogW10sDQogICAgICAvLyDlhbbku5blsZ7mgKcNCiAgICAgIG90aGVyQXR0cjogWw0KICAgICAgICB7IGtleTogJ3ByaWNlJywgbGFiZWw6ICfku7fmoLwnIH0sIA0KICAgICAgICB7IGtleTogJ3N0b2NrJywgbGFiZWw6ICflupPlrZgnIH0NCiAgICAgIF0sDQogICAgICAvLyDnlJ/miJDnmoTooajmoLzmlbDmja4NCiAgICAgIHRhYmxlRGF0YTogW10sDQogICAgICAvLyDliqjmgIHnlJ/miJDnmoTooajmoLzlhYPntKANCiAgICAgIHRhYmxlRWxlbWVudExpc3Q6IFtdDQogICAgfQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgLy8g5re75Yqg5LiA5Liq6Ieq5a6a5LmJ6KeE5qC8DQogICAgYWRkU3BlYygpIHsNCiAgICAgIGlmKHRoaXMuc3BlY0xpc3QubGVuZ3RoID09PSAzKSByZXR1cm47DQogICAgICB0aGlzLnNwZWNMaXN0LnB1c2goSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLnNwZWNUZW1wKSkpOw0KICAgIH0sDQogICAgLy8g5paw5aKe5LiA5Liq6KeE5qC85YC86L6T5YWl5qGGDQogICAgYWRkU3BlY1ZhbHVlKGl0ZW0sIGV2dCkgew0KICAgICAgaXRlbS5zcGVjVmFsLnB1c2goJycpOw0KICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gew0KICAgICAgICAvLyDmnIDlkI7kuIDkuKppbnB1dOahhuiOt+WPlueEpueCuQ0KICAgICAgICBsZXQgaW5wdXRXcnBMaXN0ID0gZXZ0LmN1cnJlbnRUYXJnZXQucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yQWxsKCcudmFsLXdyYXAnKSwNCiAgICAgICAgICBsZW4gPSBpbnB1dFdycExpc3QubGVuZ3RoOw0KICAgICAgICBpbnB1dFdycExpc3RbbGVuIC0gMV0ucXVlcnlTZWxlY3RvcignaW5wdXQnKS5mb2N1cygpOw0KICAgICAgfSk7DQogICAgfSwNCiAgICAvLyDliKDpmaTkuIDkuKrlpJrop4TmoLzlgLwtLT4g5qC55o2u57Si5byV5Yig6ZmkDQogICAgZGVsU3BlY1ZhbHVlKGluZGV4LCBhcnIpIHsNCiAgICAgIGFyci5zcGxpY2UoaW5kZXgsIDEpOw0KICAgIH0sDQogICAgZ2V0RGF0YSgpIHsNCiAgICAgIC8vIOWkhOeQhuaIkOesm+WNoeWwlOenr+eahOWFpeWPgg0KICAgICAgbGV0IGxpc3QgPSB0aGlzLnNwZWNMaXN0Lm1hcChpdGVtID0+IGl0ZW0uc3BlY1ZhbC5tYXAodW5pdCA9PiB7DQogICAgICAgIGxldCBvYmogPSB7fTsNCiAgICAgICAgb2JqW2l0ZW0uc3BlY05hbWVdID0gdW5pdDsNCiAgICAgICAgcmV0dXJuIG9iag0KICAgICAgfSkpOw0KICAgICAgLy8g5aSE55CG5oiQZWxl6KGo5qC86ZyA6KaB55qE5qC85byPDQogICAgICBsZXQgcmVzID0gdGhpcy5jYXJ0ZXNpYW4obGlzdCkubWFwKGl0ZW0gPT4gew0KICAgICAgICBsZXQgcmVzSXRlbSA9IHt9Ow0KICAgICAgICBpdGVtLmZvckVhY2gob2JqID0+IHsNCiAgICAgICAgICAvLyDnlLHkuo7plK7lkI3kuI3lm7rlrprvvIzlm6DmraTpgJrov4dmb3IuLi5pbuadpeW+queOr+WHuumUruWQjeWSjOmUruWAvA0KICAgICAgICAgIGZvcihsZXQga2V5IGluIG9iaikgew0KICAgICAgICAgICAgcmVzSXRlbVtrZXldID0gb2JqW2tleV07DQogICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgICAgLy8g55Sf5oiQ6KGo5qC855qE6ZSuDQogICAgICAgIHRoaXMudGFibGVFbGVtZW50TGlzdCA9IE9iamVjdC5rZXlzKHJlc0l0ZW0pOw0KICAgICAgICAvLyDliqDlhaXlhbbku5bnmoTlsZ7mgKcNCiAgICAgICAgdGhpcy5vdGhlckF0dHIuZm9yRWFjaCh1bml0ID0+IHsNCiAgICAgICAgICByZXNJdGVtW3VuaXQua2V5XSA9ICcnOw0KICAgICAgICB9KTsNCiAgICAgICAgcmV0dXJuIHJlc0l0ZW07DQogICAgICB9KTsNCiAgICAgIHRoaXMudGFibGVEYXRhID0gcmVzOw0KICAgICAgY29uc29sZS5sb2cocmVzKTsNCiAgICB9LA0KICAgIC8vIOaVtOWQiOaWueazlQ0KICAgIGNhcnRlc2lhbihhcnIpIHsNCiAgICAgIGlmIChhcnIubGVuZ3RoIDwgMikgcmV0dXJuIGFyclswXSB8fCBbXTsNCiAgICAgIHJldHVybiBbXS5yZWR1Y2UuY2FsbChhcnIsIGZ1bmN0aW9uIChjb2wsIHNldCkgew0KICAgICAgICBsZXQgcmVzID0gW107DQogICAgICAgIGNvbC5mb3JFYWNoKGMgPT4gew0KICAgICAgICAgIHNldC5mb3JFYWNoKHMgPT4gew0KICAgICAgICAgICAgbGV0IHQgPSBbXS5jb25jYXQoQXJyYXkuaXNBcnJheShjKSA/IGMgOiBbY10pOw0KICAgICAgICAgICAgdC5wdXNoKHMpOw0KICAgICAgICAgICAgcmVzLnB1c2godCk7DQogICAgICAgICAgfSkNCiAgICAgICAgfSk7DQogICAgICAgIHJldHVybiByZXM7DQogICAgICB9KTsNCiAgICB9DQogIH0NCn0NCg=="},{"version":3,"sources":["goodsAttr.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"goodsAttr.vue","sourceRoot":"src/components/goods","sourcesContent":["/* \r\n  商品多规格\r\n */\r\n<template>\r\n  <div class=\"wrap\">\r\n    <!-- 规格选择部分 -->\r\n    <div class=\"spec-wrap\">\r\n      <el-button size=\"mini\" @click=\"addSpec\">添加规格</el-button>\r\n      <el-button size=\"mini\" @click=\"getData\">生成</el-button>\r\n      <!-- 自定义多规格列表 -->\r\n      <div class=\"spec-list\">\r\n        <div class=\"spec-item\"\r\n          v-if=\"specList.length > 0\"\r\n          v-for=\"(obj, idx) in specList\"\r\n          :key=\"idx\">\r\n          <div class=\"spec-unit\">\r\n            <span class=\"label\">规格名</span>\r\n            <input type=\"text\" v-model=\"obj.specName\">\r\n            <el-button size=\"mini\" type=\"danger\" class=\"del-icon\" @click=\"delSpecValue(idx, specList)\">删除规格</el-button>\r\n          </div>\r\n          <div class=\"spec-unit\">\r\n            <span class=\"label\">规格值</span>\r\n            <div style=\"margin-left:90px\">\r\n              <div class=\"val-wrap\"\r\n                v-for=\"(item, key) in obj.specVal\"\r\n                :key=\"key\">\r\n                <input type=\"text\" v-model=\"obj.specVal[key]\">\r\n                <i class=\"el-icon-error\" @click=\"delSpecValue(key, obj.specVal)\"></i>\r\n              </div>\r\n              <el-button type=\"primary\" size=\"mini\" @click=\"addSpecValue(obj, $event)\">添加</el-button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <!-- 表格 -->\r\n      <div class=\"table-wrap\">\r\n        <el-table\r\n          :data=\"tableData\"\r\n          v-show=\"tableData && tableData.length > 0\"\r\n          size=\"mini\"\r\n          border\r\n          max-height=\"400\">\r\n          <el-table-column\r\n            align=\"center\"\r\n            v-for=\"(item, idx) in tableElementList\"\r\n            :key=\"idx\"\r\n            :prop=\"item\"\r\n            :label=\"item\">\r\n          </el-table-column>\r\n          <el-table-column\r\n            align=\"center\"\r\n            width=\"140\"\r\n            v-for=\"(item, idx) in otherAttr\"\r\n            :key=\"idx+item\"\r\n            :label=\"item.label\">\r\n            <template slot-scope=\"scope\">\r\n              <el-input v-model=\"scope.row[item.key]\" size=\"mini\"></el-input>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      // 多规格模板\r\n      specTemp: {\r\n        specName: '',\r\n        specVal: ['']\r\n      },\r\n      // 多规格上限\r\n      maxSpec: 3,\r\n      // 多规格列表\r\n      specList: [],\r\n      // 其他属性\r\n      otherAttr: [\r\n        { key: 'price', label: '价格' }, \r\n        { key: 'stock', label: '库存' }\r\n      ],\r\n      // 生成的表格数据\r\n      tableData: [],\r\n      // 动态生成的表格元素\r\n      tableElementList: []\r\n    }\r\n  },\r\n  methods: {\r\n    // 添加一个自定义规格\r\n    addSpec() {\r\n      if(this.specList.length === 3) return;\r\n      this.specList.push(JSON.parse(JSON.stringify(this.specTemp)));\r\n    },\r\n    // 新增一个规格值输入框\r\n    addSpecValue(item, evt) {\r\n      item.specVal.push('');\r\n      this.$nextTick(() => {\r\n        // 最后一个input框获取焦点\r\n        let inputWrpList = evt.currentTarget.parentNode.querySelectorAll('.val-wrap'),\r\n          len = inputWrpList.length;\r\n        inputWrpList[len - 1].querySelector('input').focus();\r\n      });\r\n    },\r\n    // 删除一个多规格值--> 根据索引删除\r\n    delSpecValue(index, arr) {\r\n      arr.splice(index, 1);\r\n    },\r\n    getData() {\r\n      // 处理成笛卡尔积的入参\r\n      let list = this.specList.map(item => item.specVal.map(unit => {\r\n        let obj = {};\r\n        obj[item.specName] = unit;\r\n        return obj\r\n      }));\r\n      // 处理成ele表格需要的格式\r\n      let res = this.cartesian(list).map(item => {\r\n        let resItem = {};\r\n        item.forEach(obj => {\r\n          // 由于键名不固定，因此通过for...in来循环出键名和键值\r\n          for(let key in obj) {\r\n            resItem[key] = obj[key];\r\n          }\r\n        });\r\n        // 生成表格的键\r\n        this.tableElementList = Object.keys(resItem);\r\n        // 加入其他的属性\r\n        this.otherAttr.forEach(unit => {\r\n          resItem[unit.key] = '';\r\n        });\r\n        return resItem;\r\n      });\r\n      this.tableData = res;\r\n      console.log(res);\r\n    },\r\n    // 整合方法\r\n    cartesian(arr) {\r\n      if (arr.length < 2) return arr[0] || [];\r\n      return [].reduce.call(arr, function (col, set) {\r\n        let res = [];\r\n        col.forEach(c => {\r\n          set.forEach(s => {\r\n            let t = [].concat(Array.isArray(c) ? c : [c]);\r\n            t.push(s);\r\n            res.push(t);\r\n          })\r\n        });\r\n        return res;\r\n      });\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n  .wrap {\r\n    text-align: left;\r\n    .spec-list {\r\n      .spec-unit {\r\n        // display: flex;\r\n        margin-top: 10px;\r\n        .label {\r\n          display: block;\r\n          width: 80px;\r\n          letter-spacing: 2px;\r\n          text-align: right;\r\n          margin-right: 10px;\r\n          float: left;\r\n        }\r\n        .val-wrap {\r\n          position: relative;\r\n          display: inline-block;\r\n          margin-right: 10px;\r\n          i {\r\n            position: absolute;\r\n            right: 0;\r\n            top: 0;\r\n            cursor: pointer;\r\n            display: none;\r\n          }\r\n          &:hover i {\r\n            display: block;\r\n          }\r\n        }\r\n        input {\r\n          outline: none;\r\n          border: 1px solid #ccc;\r\n          height: 22px;\r\n          line-height: 20px;\r\n          padding: 0 5px;\r\n          border-radius: 4px;\r\n        }\r\n        .del-icon {\r\n          margin-left: 10px;\r\n        }\r\n      }\r\n    }\r\n    .table-wrap {\r\n      width: 800px;\r\n      margin-top: 10px;\r\n    }\r\n  }\r\n</style>"]}]}